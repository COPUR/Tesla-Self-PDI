# Tesla Delivery Companion — Doc Pack Index

> **Purpose**   This file is an *index* that points to the individual Markdown diagrams and explanations that make up the full enterprise‑to‑implementation documentation set.
> **Layout**    All docs live under `/docs` at repo root. Filenames start with a two‑digit prefix to keep ordering intuitive.

| #  | File                                       | What you’ll find                                                 |
| -- | ------------------------------------------ | ---------------------------------------------------------------- |
| 00 | [`00_overview.md`](#00_overviewmd)         | Step‑by‑step walkthrough from enterprise context → running code. |
| 01 | [`01_context.md`](#01_contextmd)           | C4 Level‑1 (**Context**) diagram + legend.                       |
| 02 | [`02_container.md`](#02_containermd)       | C4 Level‑2 (**Container**) diagram + brief.                      |
| 03 | [`03_hexagonal.md`](#03_hexagonalmd)       | Backend hexagon, ports & adapters.                               |
| 04 | [`04_domain_map.md`](#04_domain_mapmd)     | Bounded Context Map (DDD).                                       |
| 05 | [`05_sequence_e2e.md`](#05_sequence_e2emd) | End‑to‑end delivery‑day sequence diagram.                        |
| 06 | [`06_security_dfd.md`](#06_security_dfdmd) | Security data‑flow diagram + trust boundaries.                   |
| 07 | [`07_deployment.md`](#07_deploymentmd)     | Cloud deployment diagram (Azure example).                        |

Below are the full contents for each file; copy‑paste into separate Markdown files or keep as a single doc — GitHub renders the anchors just fine.

---

## 00_overview.md

```markdown
# 0️⃣ End‑to‑End Implementation Walkthrough

1. **Enterprise Context** – Identify actors (*New Owner*, *Ops*, *External APIs*).  
2. **Define Bounded Contexts** – Order, Inspection, Media, Reporting.  
3. **Create Hexagonal Skeleton** – Domain layer + ports (use `pnpm dlx` script).  
4. **Hook up Containers** – Mobile bundle, API Gateway, Express App, Worker, DB.  
5. **Integrate External Services** – Tesla OAuth, Drive resumable, SendGrid mail.  
6. **Secure Data Flow** – TLS 1.3 everywhere, Keychain storage, SA tokens.  
7. **CI/CD** – GitHub Actions → EAS (mobile) / Docker → AKS (backend).  
8. **Observability** – Sentry (RN + Node), Datadog APM, FluentBit logs.  
9. **Compliance & Guardrails** – 12‑Factor, MASVS‑L1, GDPR purge jobs.  
10. **Operate & Evolve** – Feature flags, ADRs, schema migrations.
```

---

## 01_context.md

````markdown
# 1️⃣ Context Diagram (C4 L1)

```mermaid
graph TD
  subgraph "End Users"
    User[Driver / New Owner]
    Admin[Ops & Support]
  end

  MobileApp["Tesla Delivery Companion\n(React Native)"]
  Backend["Backend API\n(Node.js)"]
  TeslaAPI[("Tesla Fleet API\n(OAuth 2.0)")]
  Drive[("Google Drive\nService‑Acct")]
  SendGrid[(SendGrid Mail)]
  Monitoring[(Telemetry / Sentry / Datadog)]

  User -->|iOS / Android| MobileApp
  Admin -->|Web| MobileApp
  MobileApp -->|HTTPS REST| Backend
  Backend -->|PKCE flow| TeslaAPI
  Backend -->|Resumable upload| Drive
  Backend -->|Mail Send| SendGrid
  MobileApp -.-> Monitoring
  Backend --> Monitoring
````

---

## 02_container.md

```markdown
# 2️⃣ Container Diagram (C4 L2)

```mermaid
graph LR
  subgraph "Mobile"
    RNApp[React‑Native Bundle]
    Cache[(SQLite / MMKV)]
    Keychain[(Keychain / Keystore)]
  end

  subgraph "Server"
    APIGW[API Gateway\nTLS + rate‑limit]
    Express[Express App]
    Worker[Queue Worker]
    DB[(PostgreSQL)]
  end

  RNApp --> APIGW
  APIGW --> Express
  Express --> DB
  Express <--> Worker
  Express -->|events| Monitoring

  %% external
  Express --> TeslaAPI
  Express --> Drive
  Express --> SendGrid
````

---

## 03_hexagonal.md

```markdown
# 3️⃣ Backend Hexagonal Core

```mermaid
graph TD
  subgraph "Domain"
    OrderAgg[Order Aggregate]
    InspectionAgg[Inspection Aggregate]
    MediaAgg[Media Aggregate]
    ReportAgg[Report Aggregate]
  end

  subgraph "Inbound Adapters"
    REST[REST Controller]
    Webhook[Webhook Listener]
    Cron[Scheduled Job]
  end

  subgraph "Outbound Adapters"
    TeslaPort[Tesla API Port]
    DrivePort[Drive Port]
    MailPort[Mail Port]
    DBPort[DB Port]
  end

  REST --> OrderAgg & InspectionAgg
  Webhook --> MediaAgg
  Cron --> ReportAgg

  OrderAgg --> TeslaPort
  InspectionAgg --> DBPort
  MediaAgg --> DrivePort
  ReportAgg --> MailPort
````

---

## 04_domain_map.md

```markdown
# 4️⃣ Bounded Context Map

```mermaid
graph LR
  OrderBC("Order BC")
  InspectionBC("Inspection BC")
  MediaBC("Media BC")
  ReportingBC("Reporting BC")

  OrderBC --"VIN, DeliverySlot"--> InspectionBC
  InspectionBC --"FaultSummary"--> ReportingBC
  InspectionBC --"UploadToken"--> MediaBC
  MediaBC --"MediaLink"--> InspectionBC
````

---

## 05_sequence_e2e.md

```markdown
# 5️⃣ End‑to‑End Sequence (Delivery Day)

```mermaid
sequenceDiagram
  participant User
  participant App as ReactNativeApp
  participant Cache as OfflineCache
  participant APIGW as Gateway
  participant BE as Backend
  participant Tesla as TeslaAPI
  participant Drive
  participant Mail as SendGrid

  User ->> App: Start PDI
  App ->> Cache: loadChecklist()
  Cache -->> App: checklist
  loop each item
    User ->> App: mark pass/fail
  end
  alt Item failed
    App ->> App: capture photo/video
    App ->> Cache: save media
  end
  User ->> App: sign
  alt Offline
    App ->> Cache: queue submit
  else Online
    App ->> APIGW: POST /inspection
    APIGW ->> BE
    BE ->> Drive: upload media (resumable)
    BE ->> Tesla: fetch order/user email
    BE ->> Drive: create PDF
    BE ->> Mail: send PDF
    BE -->> App: status 204
    App ->> Cache: purge local media
  end
  App -->> User: Success screen
````

---

## 06_security_dfd.md

```markdown
# 6️⃣ Security Data‑Flow

```mermaid
flowchart TB
  User -->|TLS| Mobile
  Mobile -->|TLS| Backend
  Backend -->|TLS+JWT| Tesla
  Backend -->|TLS+SA| Drive
  Backend -->|TLS+API| SendGrid

  classDef boundary fill:#f0f8ff,stroke:#000;
  class Mobile,Backend boundary;
````

---

## 07_deployment.md

```markdown
# 7️⃣ Cloud Deployment (Azure EU)

```mermaid
graph TD
  subgraph Azure_EU[Azure / EU Region]
    LB[Layer‑4 LB]
    AKS[(AKS Cluster)]
    AKS --> WebPod[web pod]
    AKS --> WorkerPod[worker pod]
    AKS --> CronPod[cron]
    Postgres[(Azure Postgres)]
  end

  WebPod --> Postgres
  WorkerPod --> Postgres
  CronPod --> Postgres

  WebPod --> Drive & TeslaAPI & SendGrid
````

---

### How to use this index

Either keep this single file (*GitHub renders anchors nicely*) **or** split each fenced block into its own Markdown file inside `/docs`. The filenames in the index reflect the recommended structure.

